{% extends "base.html" %}

{% block title %}{{ 'Edit' if asset else 'Create' }} asset - Recycle IT{% endblock %}

{% block content %}
  <div class="d-flex flex-column flex-lg-row align-items-lg-center justify-content-between gap-3 mb-4">
    <div>
      <h1 class="h3 mb-1">{{ 'Edit asset' if asset else 'Log new asset' }}</h1>
      <p class="text-muted mb-0">Capture essential details about each donated item so you can track its journey end-to-end.</p>
    </div>
    <a class="btn btn-outline-secondary" href="{{ url_for('main.asset_list') }}">Back to list</a>
  </div>

  <form class="card shadow-sm" method="post" action="{{ form_action }}">
    <div class="card-body">
      <div class="row g-4">
        <div class="col-md-6">
          <label class="form-label" for="tag">Asset tag *</label>
          <input class="form-control" id="tag" name="tag" required type="text" value="{{ asset.tag if asset else '' }}" />
        </div>
        <div class="col-md-6">
          <label class="form-label" for="asset_type">Asset type *</label>
          <input class="form-control" id="asset_type" name="asset_type" required type="text" value="{{ asset.asset_type if asset else '' }}" />
        </div>
        <div class="col-md-4">
          <label class="form-label" for="brand">Brand</label>
          <input class="form-control" id="brand" name="brand" type="text" value="{{ asset.brand if asset else '' }}" />
        </div>
        <div class="col-md-4">
          <label class="form-label" for="model">Model</label>
          <input class="form-control" id="model" name="model" type="text" value="{{ asset.model if asset else '' }}" />
        </div>
        <div class="col-md-4">
          <label class="form-label" for="serial_number">Serial number</label>
          <input class="form-control" id="serial_number" name="serial_number" type="text" value="{{ asset.serial_number if asset else '' }}" />
        </div>
        <div class="col-md-4">
          <label class="form-label" for="condition">Condition</label>
          <input class="form-control" id="condition" name="condition" type="text" value="{{ asset.condition if asset else '' }}" />
        </div>
        <div class="col-md-4">
          <label class="form-label" for="status">Lifecycle status</label>
          <select class="form-select" id="status" name="status">
            {% for value, label in STATUS_CHOICES %}
              <option value="{{ value }}" {% if asset and asset.status == value %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label" for="acquired_date">Date acquired</label>
          <input class="form-control" id="acquired_date" name="acquired_date" type="date" value="{{ asset.acquired_date|default('', true) }}" />
        </div>
        <div class="col-md-4">
          <label class="form-label" for="weight_kg">Weight (kg)</label>
          <input class="form-control" id="weight_kg" name="weight_kg" min="0" step="0.1" type="number" value="{{ asset.weight_kg if asset and asset.weight_kg is not none else '' }}" />
        </div>
        <div class="col-md-4">
          <label class="form-label" for="donor_id">Donor</label>
          <select class="form-select" id="donor_id" name="donor_id">
            <option value="">-- None --</option>
            {% for donor in donors %}
              <option value="{{ donor.id }}" {% if asset and asset.donor_id == donor.id %}selected{% endif %}>{{ donor.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label" for="recipient_id">Recipient</label>
          <select class="form-select" id="recipient_id" name="recipient_id">
            <option value="">-- None --</option>
            {% for recipient in recipients %}
              <option value="{{ recipient.id }}" {% if asset and asset.recipient_id == recipient.id %}selected{% endif %}>{{ recipient.name }}</option>
            {% endfor %}
          </select>
        </div>
        <div class="col-md-4">
          <label class="form-label" for="location">Current location</label>
          <input class="form-control" id="location" name="location" type="text" value="{{ asset.location if asset else '' }}" />
        </div>
        <div class="col-12">
          <label class="form-label" for="notes">Internal notes</label>
          <textarea class="form-control" id="notes" name="notes" rows="3">{{ asset.notes if asset else '' }}</textarea>
        </div>
      </div>
    </div>

    {% if not asset %}
      <div class="card-footer bg-light">
        <div class="row g-3">
          <div class="col-md-6">
            <label class="form-label" for="recorded_by">Logged by</label>
            <input class="form-control" id="recorded_by" name="recorded_by" placeholder="Team member name" type="text" />
          </div>
          <div class="col-md-6">
            <label class="form-label" for="note">Initial note</label>
            <input class="form-control" id="note" name="note" placeholder="E.g. Collected from community centre" type="text" />
          </div>
        </div>
      </div>
    {% endif %}

    <div class="card-footer text-end">
      <button class="btn btn-success" type="submit">{{ submit_label }}</button>
    </div>
  </form>
{% endblock %}
